webpackJsonp([1],{AWDr:function(t,e,s){"use strict";(function(t){var a=s("woOf"),o=s.n(a),r=s("KcqS"),i=s("dQ4z"),d=s("olkN");e.a={data:function(){return{sharestate:d.a.state,posts:{_meta:{page:1,per_page:10}},delPostid:"",postForm:{title:"",summary:"",body:"",errors:0,titleError:null,bodyError:null},editForm:{title:"",summary:"",body:"",errors:0,titleError:null,bodyError:null}}},components:{Post:r.a,Pagination:i.a},methods:{onEditPost:function(e){this._tearDownFormError("editForm"),this.editForm=o()(this.editForm,e),t("#edit_body").markdown({autofocus:!1,savable:!1,iconlibrary:"fa",language:"zh"})},onSubmitUpdate:function(){var e=this;this._tearDownFormError("editForm");var s=this.editForm,a=s.title,o=s.summary,r=s.body,i=s.id,d="/posts/"+i;if(""!=t.trim(a)&&this.editForm.title||(this.editForm.errors+=1,this.editForm.titleError="Please input your title."),""!=t.trim(r)&&this.editForm.body?t("#edit_body").parent(".md-editor").removeClass("is-invalid"):(this.editForm.errors+=1,this.editForm.bodyError="Please input your article.",t("#edit_body").parent(".md-editor").addClass("is-invalid")),!this.editForm.errors){var l={title:a,summary:o,body:r,id:i};this.$axios.put(d,l).then(function(s){t("#exampleModal").modal("hide"),e.$toasted.success("修改成功"),e._getPosts()}).catch(function(t){e.$toasted.error("修改失败")})}},onDeletePost:function(){var e=this;if(this.delPostid){var s="/posts/"+this.delPostid;this.$axios.delete(s).then(function(s){e.$toasted.success("删除成功"),t("#modalDelete").modal("hide"),e._getPosts()}).catch(function(s){e.$toasted.error("删除失败"),t("#modalDelete").modal("hide"),console.log(s)})}else this.$toasted.success("Ooooh No !")},_tearDownFormError:function(t){switch(t){case"editForm":this.editForm.errors=0,this.editForm.titleError="",this.editForm.bodyError="";break;case"postForm":this.postForm.errors=0,this.postForm.titleError="",this.postForm.bodyError="";break;case"All":this.editForm.errors=0,this.editForm.titleError="",this.editForm.bodyError="",this.postForm.errors=0,this.postForm.titleError="",this.postForm.bodyError=""}},_getPosts:function(t){var e=this,s=1,a=4;this.$route.query.page&&this.$route.query.per_page&&(this.$route.query.page<1||this.$route.query.page>this.posts._meta.total_pages||this.$route.query.per_page<1)&&this.$router.back(),void 0!==this.$route.query.page&&(s=this.$route.query.page),void 0!==this.$route.query.per_page&&(a=this.$route.query.per_page);var o="/users/"+t+"/posts/";this.$axios.get(o,{params:{page:s,per_page:a}}).then(function(t){console.log("Posts:",t),e.posts=t.data}).catch(function(t){console.log(t)})}},created:function(){var t=this.$route.params.id;this._getPosts(t)},beforeRouteUpdate:function(t,e,s){s(),this._getPosts(t.params.id)}}}).call(e,s("7t+N"))},J9qB:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("AWDr"),o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"modal fade",attrs:{id:"exampleModal",tabindex:"-1",role:"dialog","data-backdrop":"static","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-lg modal-dialog-centered",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),s("div",{staticClass:"modal-body"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmitUpdate(e)},reset:function(e){return e.preventDefault(),t.onResetUpdate(e)}}},[s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editForm.title,expression:"editForm.title"}],class:{"form-control":!0,"is-invalid":t.editForm.titleError},attrs:{type:"text",id:"edit_title",placeholder:"标题",required:""},domProps:{value:t.editForm.title},on:{input:function(e){e.target.composing||t.$set(t.editForm,"title",e.target.value)}}}),t._v(" "),s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.editForm.titleError))])]),t._v(" "),s("div",{staticClass:"form-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.editForm.summary,expression:"editForm.summary"}],staticClass:"form-control",attrs:{type:"text",id:"edit_summary",placeholder:"摘要"},domProps:{value:t.editForm.summary},on:{input:function(e){e.target.composing||t.$set(t.editForm,"summary",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.editForm.body,expression:"editForm.body"}],staticClass:"form-control",attrs:{id:"edit_body",rows:"5"},domProps:{value:t.editForm.body},on:{input:function(e){e.target.composing||t.$set(t.editForm,"body",e.target.value)}}}),t._v(" "),s("div",{staticClass:"invalid-feedback"},[t._v(t._s(t.editForm.bodyError))])]),t._v(" "),t._m(1)])])])])]),t._v(" "),s("div",{staticClass:"modal fade",attrs:{id:"modalDelete",tabindex:"-1",role:"dialog","aria-labelledby":"modalDeleteLabel","aria-hidden":"true"}},[s("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[s("div",{staticClass:"modal-content"},[t._m(2),t._v(" "),s("div",{staticClass:"modal-body"},[t._v("\r\n          Are you sure？\r\n      ")]),t._v(" "),s("div",{staticClass:"modal-footer"},[s("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("No")]),t._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.onDeletePost}},[t._v("Yes")])])])])]),t._v(" "),s("div",{staticClass:"card border-0 mb-5"},[s("div",{staticClass:"card-header d-flex align-items-center justify-content-between bg-light border-0 mb-3"},[s("div",{staticClass:"float-left"},[s("i",{staticClass:"fa fa-commenting-o"}),t._v("\r\n        All Posts\r\n        "),s("small",{staticClass:"font-weight-normal"},[t._v("（共"+t._s(t.posts._meta?t.posts._meta.total_items:"")+"篇，"+t._s(t.posts._meta?t.posts._meta.total_pages:"")+"页）")])]),t._v(" "),t._m(3)]),t._v(" "),t.posts?s("div",t._l(t.posts.items,function(e,a){return s("post",{key:a,attrs:{post:e},on:{"edit-post":function(s){return t.onEditPost(e)},"del-post":function(s){t.delPostid=e.id}}})}),1):t._e(),t._v(" "),s("pagination",{attrs:{curPage:t.posts._meta.page,perPage:t.posts._meta.per_page,totalPage:t.posts._meta.total_pages}})],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[this._v("Update Post")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[this._v("Cancel")]),this._v(" "),e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[this._v("Update")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title",attrs:{id:"modalDeleteLabel"}},[this._v("Delete")]),this._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[e("span",{attrs:{"aria-hidden":"true"}},[this._v("×")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"dropdown"},[e("div",{attrs:{id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[e("i",{staticClass:"fa fa-bars"})]),this._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"dropdownMenuButton"}},[e("a",{staticClass:"dropdown-item",attrs:{href:"#"}},[this._v("-")])])])}]},r=s("VU/8")(a.a,o,!1,null,null,null);e.default=r.exports},KcqS:function(t,e,s){"use strict";var a=s("olkN"),o=s("Xoog"),r={props:["post"],components:{VueMarkdown:s.n(o).a},data:function(){return{sharestate:a.a.state}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"card-body border mb-3 d-flex align-items-start"},[s("div",{},[s("img",{staticClass:"d-flex mr-4",staticStyle:{width:"50px"},attrs:{src:t.post.author._links.avatar,alt:""}})]),t._v(" "),s("div",{staticClass:"w-75",staticStyle:{flex:"1"}},[s("div",{staticClass:"mb-2 d-flex justify-content-between flex-wrap"},[s("router-link",{staticClass:"h5 text-truncate w-75",attrs:{to:{name:"PostDetail",params:{id:t.post.id}}}},[t._v(t._s(t.post.title))]),t._v(" "),s("div",{staticClass:"d-inline-block  text-truncate"},[s("small",[t._v(t._s(t.$moment(t.post.timestamp).fromNow())+" /")]),t._v(" "),s("router-link",{attrs:{to:{path:"/user/"+t.post.author.id}}},[s("small",[t._v(t._s(t.post.author.username||t.post.author.name))])])],1)],1),t._v(" "),s("div",{staticClass:"d-block text-wrap overflow-hidden mb-2",staticStyle:{height:"3em"}},[t._v("\n                "+t._s(t.post.summary)+"\n            ")]),t._v(" "),s("div",{staticClass:"d-flex justify-content-between align-items-center"},[s("div",{},[s("i",{staticClass:"fa fa-eye text-muted mr-1"}),s("small",[t._v(t._s(t.post.views))])]),t._v(" "),s("div",{staticClass:"btn-group",attrs:{role:"group"}},[s("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button","data-toggle":"modal","data-target":"#exampleModal",disabled:t.sharestate.user_id!=t.post.author.id},on:{click:function(e){return t.$emit("edit-post")}}},[t._v("编辑")]),t._v(" "),s("button",{staticClass:"btn btn-outline-secondary btn-sm",attrs:{type:"button","data-toggle":"modal","data-target":"#modalDelete",disabled:t.sharestate.user_id!=t.post.author.id},on:{click:function(e){return t.$emit("del-post")}}},[t._v("删除")])])])])])])},staticRenderFns:[]},d=s("VU/8")(r,i,!1,null,null,null);e.a=d.exports},R4wc:function(t,e,s){var a=s("kM2E");a(a.S+a.F,"Object",{assign:s("To3L")})},To3L:function(t,e,s){"use strict";var a=s("+E39"),o=s("lktj"),r=s("1kS7"),i=s("NpIQ"),d=s("sB3e"),l=s("MU5D"),n=Object.assign;t.exports=!n||s("S82l")(function(){var t={},e={},s=Symbol(),a="abcdefghijklmnopqrst";return t[s]=7,a.split("").forEach(function(t){e[t]=t}),7!=n({},t)[s]||Object.keys(n({},e)).join("")!=a})?function(t,e){for(var s=d(t),n=arguments.length,m=1,c=r.f,u=i.f;n>m;)for(var p,v=l(arguments[m++]),h=c?o(v).concat(c(v)):o(v),_=h.length,b=0;_>b;)p=h[b++],a&&!u.call(v,p)||(s[p]=v[p]);return s}:n},V3tA:function(t,e,s){s("R4wc"),t.exports=s("FeBl").Object.assign},woOf:function(t,e,s){t.exports={default:s("V3tA"),__esModule:!0}}});
//# sourceMappingURL=1.76378fb7ad0c262f57a7.js.map