(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{cbf2:function(t,e,i){"use strict";i.r(e);var l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ImgUpload",{model:{value:t.imgfile,callback:function(e){t.imgfile=e},expression:"imgfile"}}),i("div",{staticClass:"q-pa-md"},[i("q-input",{staticClass:"q-mb-xl",attrs:{label:"菜名"},model:{value:t.fieldForm.title,callback:function(e){t.$set(t.fieldForm,"title",e)},expression:"fieldForm.title"}}),i("div",{staticClass:"q-mb-lg"},[i("div",{staticClass:"text-weight-bold q-mb-sm"},[t._v("描述")]),i("q-input",{attrs:{filled:"",type:"textarea"},model:{value:t.fieldForm.description,callback:function(e){t.$set(t.fieldForm,"description",e)},expression:"fieldForm.description"}})],1),i("div",{staticClass:"q-mb-lg"},[i("div",{staticClass:"text-weight-bold q-mb-sm"},[t._v("食材")]),i("CustomGrid",{model:{value:t.fieldForm.foodItems,callback:function(e){t.$set(t.fieldForm,"foodItems",e)},expression:"fieldForm.foodItems"}})],1),i("div",{staticClass:"q-mb-lg"},[i("div",{staticClass:"text-weight-bold q-mb-sm"},[t._v("步骤")]),i("q-input",{attrs:{filled:"",type:"textarea"},model:{value:t.fieldForm.step,callback:function(e){t.$set(t.fieldForm,"step",e)},expression:"fieldForm.step"}})],1),i("div",[i("q-btn",{staticStyle:{width:"100%"},attrs:{color:"primary",label:"发布"},on:{click:t.handlePublish}})],1)],1)],1)},a=[],s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{},[i("input",{ref:"inputer",attrs:{type:"file",id:"upload_img",accept:"image/png,image/jpeg,image/bmp",hidden:""},on:{change:t.handleImgChange}}),t.dataUrl?i("div",{staticClass:"relative-position"},[i("q-btn",{staticClass:"absolute",staticStyle:{top:"20px",right:"20px"},attrs:{round:"",dense:"",color:"negative",icon:"delete_outline"},on:{click:t.handleDelete}}),i("img",{staticStyle:{width:"100%","object-fit":"scale-down"},attrs:{src:t.dataUrl,alt:""}})],1):i("div",{staticClass:"bg-grey-4 relative-position",staticStyle:{height:"30vh"}},[t._m(0)])])},n=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{staticClass:"absolute",staticStyle:{top:"0",right:"0",bottom:"0",left:"0"},attrs:{for:"upload_img"}},[i("span",{staticClass:"flex flex-center absolute-center text-grey text-h6"},[t._v("点击添加封面")])])}],o={data:function(){return{dataUrl:""}},methods:{imgPreview:function(t){t&&URL.createObjectURL&&/^image/.test(t.type)&&(this.dataUrl=URL.createObjectURL(t),console.log(this.dataUrl))},handleDelete:function(){this.dataUrl="",this.$emit("input",null)},handleImgChange:function(t){var e=this.$refs.inputer;this.imgfile=e.files[0],this.errText="";var i=Math.floor(this.imgfile.size/1024);if(i>5e3)return!1;this.imgPreview(this.imgfile),this.$emit("input",this.imgfile)}}},r=o,c=i("2877"),d=i("eebe"),u=i.n(d),m=i("9c40"),p=Object(c["a"])(r,s,n,!1,null,null,null),f=p.exports;u()(p,"components",{QBtn:m["a"]});var h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("q-markup-table",{staticClass:"q-mb-sm",attrs:{flat:"",square:""}},[i("tbody",t._l(t.value,(function(e,l){return i("tr",{key:l},[i("td",[i("q-input",{attrs:{placeholder:"名字",borderless:"",dense:"","input-style":"padding:0;"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}})],1),i("td",[i("q-input",{attrs:{placeholder:"数量",borderless:"",dense:"","input-style":"padding:0;"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}})],1),i("td",[i("q-btn",{attrs:{size:"sm",flat:"",dense:"",icon:"clear"},on:{click:function(e){return t.handleDeleteRow(l)}}})],1)])})),0)]),i("q-btn",{staticStyle:{width:"100%"},attrs:{color:"grey-3","text-color":"grey-7",unelevated:"",icon:"add",size:"sm",dense:""},on:{click:t.handleAddRow}})],1)},v=[],g=(i("7f7f"),{props:{value:{type:Array}},data:function(){return{}},methods:{handleAddRow:function(){this.value.push({name:"",value:""})},handleDeleteRow:function(t){if(this.value.length<=1)return this.value[0].name="",void(this.value[0].value="");this.value.splice(t,1)}}}),b=g,x=i("2bb1"),y=i("27f9"),k=Object(c["a"])(b,h,v,!1,null,null,null),q=k.exports;u()(k,"components",{QMarkupTable:x["a"],QInput:y["a"],QBtn:m["a"]});var w={components:{ImgUpload:f,CustomGrid:q},data:function(){return{imgfile:null,fieldForm:{title:"",description:"",foodItems:[{name:"",value:""}],step:""},foo:""}},methods:{handlePublish:function(){var t=this,e=new FormData,i={headers:{"Content-Type":"multipart/form-data"}},l="api/cookbooks";e.append("imgfile",this.imgfile),e.append("name",this.fieldForm.title),e.append("description",this.fieldForm.description),e.append("myfoods",JSON.stringify(this.fieldForm.foodItems)),e.append("step",this.fieldForm.step),this.$axios.post(l,e,i).then((function(e){t.$toasted.success("发布成功."),t.$router.push("/cookbooks")})).catch((function(t){console.log(t.response)}))},_ping:function(){var t="api/ping";this.$axios.get(t).then((function(t){})).catch((function(t){}))}},created:function(){this._ping()}},C=w,_=Object(c["a"])(C,l,a,!1,null,null,null);e["default"]=_.exports;u()(_,"components",{QInput:y["a"],QBtn:m["a"]})}}]);